// Compiled by ClojureScript 0.0-2173
goog.provide('playfair_cljs.shapes');
goog.require('cljs.core');
goog.require('cljs.core.async');
goog.require('playfair_cljs.appstate');
goog.require('playfair_cljs.appstate');
goog.require('cljs.reader');
goog.require('cljs.reader');
goog.require('playfair_cljs.math');
goog.require('playfair_cljs.math');
goog.require('cljs.core.async');
goog.require('playfair_cljs.debug');
goog.require('playfair_cljs.debug');
playfair_cljs.shapes.canvas_chan = cljs.core.async.chan.call(null);
playfair_cljs.shapes.canvas_size = new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [500,500], null);
playfair_cljs.shapes.get_pos_key = (function get_pos_key(shape_name){return shape_name.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"rect","rect",1017400662),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null),new cljs.core.Keyword(null,"path","path",1017337751),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null),new cljs.core.Keyword(null,"line","line",1017226086),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x1","x1",1013908011),new cljs.core.Keyword(null,"y1","y1",1013908042),new cljs.core.Keyword(null,"x2","x2",1013908012),new cljs.core.Keyword(null,"y2","y2",1013908043)], null),new cljs.core.Keyword(null,"circle","circle",3948654658),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"cx","cx",1013907431),new cljs.core.Keyword(null,"cy","cy",1013907432)], null)], null));
});
playfair_cljs.shapes.rect_nodes = new cljs.core.PersistentVector(null, 9, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015),new cljs.core.Keyword(null,"middle-right-node","middle-right-node",3976603069),new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837),new cljs.core.Keyword(null,"bottom-center-node","bottom-center-node",2609391434),new cljs.core.Keyword(null,"middle-center-node","middle-center-node",1498126260),new cljs.core.Keyword(null,"top-center-node","top-center-node",4151893876),new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984),new cljs.core.Keyword(null,"middle-left-node","middle-left-node",3682637122),new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098)], null);
playfair_cljs.shapes.circle_nodes = new cljs.core.PersistentVector(null, 5, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"top-node","top-node",4296511212),new cljs.core.Keyword(null,"center-node","center-node",2639619052),new cljs.core.Keyword(null,"bottom-node","bottom-node",4653566934),new cljs.core.Keyword(null,"right-node","right-node",3874878085),new cljs.core.Keyword(null,"left-node","left-node",2709524346)], null);
playfair_cljs.shapes.line_nodes = new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.Keyword(null,"middle-point","middle-point",4048024266),new cljs.core.Keyword(null,"last-point","last-point",1861953291)], null);
playfair_cljs.shapes.check_snap = (function check_snap(thing){var or__3441__auto__ = cljs.core._EQ_.call(null,thing,new cljs.core.Keyword(null,"canvas","canvas",3941165258));if(or__3441__auto__)
{return or__3441__auto__;
} else
{if((cljs.core.vector_QMARK_.call(null,thing)) && ((cljs.core.count.call(null,thing) > 0)))
{return cljs.core.some.call(null,(function (x){return cljs.core._EQ_.call(null,x,thing.call(null,0));
}),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"rect","rect",1017400662),new cljs.core.Keyword(null,"path","path",1017337751),new cljs.core.Keyword(null,"line","line",1017226086),new cljs.core.Keyword(null,"circle","circle",3948654658)], null));
} else
{return false;
}
}
});
playfair_cljs.shapes.make_renderable = (function make_renderable(p__12758){var map__12760 = p__12758;var map__12760__$1 = ((cljs.core.seq_QMARK_.call(null,map__12760))?cljs.core.apply.call(null,cljs.core.hash_map,map__12760):map__12760);var path = cljs.core.get.call(null,map__12760__$1,new cljs.core.Keyword(null,"path","path",1017337751));var line = cljs.core.get.call(null,map__12760__$1,new cljs.core.Keyword(null,"line","line",1017226086));var circle = cljs.core.get.call(null,map__12760__$1,new cljs.core.Keyword(null,"circle","circle",3948654658));var rect = cljs.core.get.call(null,map__12760__$1,new cljs.core.Keyword(null,"rect","rect",1017400662));return cljs.core.vec.call(null,cljs.core.flatten.call(null,cljs.core.conj.call(null,cljs.core.PersistentVector.EMPTY,rect,circle,line,path)));
});
playfair_cljs.shapes.regular_node_vis = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"className","className",1004015509),"reg-node",new cljs.core.Keyword(null,"stroke","stroke",4416891306),"#225E79",new cljs.core.Keyword(null,"fill","fill",1017047285),"gray",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null);
playfair_cljs.shapes.active_node_vis = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"className","className",1004015509),"reg-node",new cljs.core.Keyword(null,"stroke","stroke",4416891306),"#225E79",new cljs.core.Keyword(null,"fill","fill",1017047285),"blue",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null);
playfair_cljs.shapes.snap_node_vis = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"className","className",1004015509),"active-node",new cljs.core.Keyword(null,"stroke","stroke",4416891306),"#225E79",new cljs.core.Keyword(null,"fill","fill",1017047285),"#FFD035",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null);
playfair_cljs.shapes.rotate_point_around_point = (function rotate_point_around_point(p__12761,p__12762,rotate_val){var vec__12765 = p__12761;var origin_x = cljs.core.nth.call(null,vec__12765,0,null);var origin_y = cljs.core.nth.call(null,vec__12765,1,null);var vec__12766 = p__12762;var x = cljs.core.nth.call(null,vec__12766,0,null);var y = cljs.core.nth.call(null,vec__12766,1,null);var rotate_angle = (rotate_val * (2 * playfair_cljs.math.PI));var r = playfair_cljs.math.distance_formula.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [origin_x,origin_y], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null));var current_angle = (((y > origin_y))?playfair_cljs.math.acos.call(null,((x - origin_x) / r)):((2 * playfair_cljs.math.PI) - playfair_cljs.math.acos.call(null,((x - origin_x) / r))));var new_angle = (rotate_angle + current_angle);if((cljs.core._EQ_.call(null,origin_x,x)) && (cljs.core._EQ_.call(null,origin_y,y)))
{return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null);
} else
{return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(origin_x + (r * playfair_cljs.math.cos.call(null,new_angle))),(origin_y + (r * playfair_cljs.math.sin.call(null,new_angle)))], null);
}
});
playfair_cljs.shapes.get_rect_node_points = (function get_rect_node_points(p__12767){var map__12769 = p__12767;var map__12769__$1 = ((cljs.core.seq_QMARK_.call(null,map__12769))?cljs.core.apply.call(null,cljs.core.hash_map,map__12769):map__12769);var height = cljs.core.get.call(null,map__12769__$1,new cljs.core.Keyword(null,"height","height",4087841945));var width = cljs.core.get.call(null,map__12769__$1,new cljs.core.Keyword(null,"width","width",1127031096));var y = cljs.core.get.call(null,map__12769__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12769__$1,new cljs.core.Keyword(null,"x","x",1013904362));return cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"middle-center-node","middle-center-node",1498126260),new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098),new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837),new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984),new cljs.core.Keyword(null,"bottom-center-node","bottom-center-node",2609391434),new cljs.core.Keyword(null,"top-center-node","top-center-node",4151893876),new cljs.core.Keyword(null,"middle-left-node","middle-left-node",3682637122),new cljs.core.Keyword(null,"middle-right-node","middle-right-node",3976603069),new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015)],[new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + (width / 2)),new cljs.core.Keyword(null,"y","y",1013904363),(y + (height / 2))], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x,new cljs.core.Keyword(null,"y","y",1013904363),y], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + width),new cljs.core.Keyword(null,"y","y",1013904363),y], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x,new cljs.core.Keyword(null,"y","y",1013904363),(y + height)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + (width / 2)),new cljs.core.Keyword(null,"y","y",1013904363),(y + height)], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + (width / 2)),new cljs.core.Keyword(null,"y","y",1013904363),y], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x,new cljs.core.Keyword(null,"y","y",1013904363),(y + (height / 2))], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + width),new cljs.core.Keyword(null,"y","y",1013904363),(y + (height / 2))], null),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(x + width),new cljs.core.Keyword(null,"y","y",1013904363),(y + height)], null)]);
});
playfair_cljs.shapes.get_line_node_points = (function get_line_node_points(p__12770){var map__12772 = p__12770;var map__12772__$1 = ((cljs.core.seq_QMARK_.call(null,map__12772))?cljs.core.apply.call(null,cljs.core.hash_map,map__12772):map__12772);var y2 = cljs.core.get.call(null,map__12772__$1,new cljs.core.Keyword(null,"y2","y2",1013908043));var x2 = cljs.core.get.call(null,map__12772__$1,new cljs.core.Keyword(null,"x2","x2",1013908012));var y1 = cljs.core.get.call(null,map__12772__$1,new cljs.core.Keyword(null,"y1","y1",1013908042));var x1 = cljs.core.get.call(null,map__12772__$1,new cljs.core.Keyword(null,"x1","x1",1013908011));return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x1,new cljs.core.Keyword(null,"y","y",1013904363),y1], null),new cljs.core.Keyword(null,"middle-point","middle-point",4048024266),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),((x1 + x2) / 2),new cljs.core.Keyword(null,"y","y",1013904363),((y1 + y2) / 2)], null),new cljs.core.Keyword(null,"last-point","last-point",1861953291),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x2,new cljs.core.Keyword(null,"y","y",1013904363),y2], null)], null);
});
playfair_cljs.shapes.get_circle_node_points = (function get_circle_node_points(p__12773){var map__12775 = p__12773;var map__12775__$1 = ((cljs.core.seq_QMARK_.call(null,map__12775))?cljs.core.apply.call(null,cljs.core.hash_map,map__12775):map__12775);var r = cljs.core.get.call(null,map__12775__$1,new cljs.core.Keyword(null,"r","r",1013904356));var cy = cljs.core.get.call(null,map__12775__$1,new cljs.core.Keyword(null,"cy","cy",1013907432));var cx = cljs.core.get.call(null,map__12775__$1,new cljs.core.Keyword(null,"cx","cx",1013907431));return new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"top-node","top-node",4296511212),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),cx,new cljs.core.Keyword(null,"y","y",1013904363),(cy - r)], null),new cljs.core.Keyword(null,"center-node","center-node",2639619052),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),cx,new cljs.core.Keyword(null,"y","y",1013904363),cy], null),new cljs.core.Keyword(null,"bottom-node","bottom-node",4653566934),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),cx,new cljs.core.Keyword(null,"y","y",1013904363),(cy + r)], null),new cljs.core.Keyword(null,"right-node","right-node",3874878085),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(cx + r),new cljs.core.Keyword(null,"y","y",1013904363),cy], null),new cljs.core.Keyword(null,"left-node","left-node",2709524346),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(cx - r),new cljs.core.Keyword(null,"y","y",1013904363),cy], null)], null);
});
playfair_cljs.shapes.attrs_to_nodes = (function attrs_to_nodes(shape_key,pos_attrs){return shape_key.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"rect","rect",1017400662),playfair_cljs.shapes.get_rect_node_points.call(null,pos_attrs),new cljs.core.Keyword(null,"circle","circle",3948654658),playfair_cljs.shapes.get_circle_node_points.call(null,pos_attrs),new cljs.core.Keyword(null,"line","line",1017226086),playfair_cljs.shapes.get_line_node_points.call(null,pos_attrs)], null));
});
playfair_cljs.shapes.nodes_to_attrs = (function nodes_to_attrs(shape_key,node_map){if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"rect","rect",1017400662)))
{var map__12781 = node_map;var map__12781__$1 = ((cljs.core.seq_QMARK_.call(null,map__12781))?cljs.core.apply.call(null,cljs.core.hash_map,map__12781):map__12781);var bottom_right_node = cljs.core.get.call(null,map__12781__$1,new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015));var top_left_node = cljs.core.get.call(null,map__12781__$1,new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098));return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(top_left_node),new cljs.core.Keyword(null,"y","y",1013904363),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(top_left_node),new cljs.core.Keyword(null,"height","height",4087841945),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(bottom_right_node) - new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(top_left_node)),new cljs.core.Keyword(null,"width","width",1127031096),(new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(bottom_right_node) - new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(top_left_node))], null);
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"circle","circle",3948654658)))
{var map__12782 = node_map;var map__12782__$1 = ((cljs.core.seq_QMARK_.call(null,map__12782))?cljs.core.apply.call(null,cljs.core.hash_map,map__12782):map__12782);var top_node = cljs.core.get.call(null,map__12782__$1,new cljs.core.Keyword(null,"top-node","top-node",4296511212));var center_node = cljs.core.get.call(null,map__12782__$1,new cljs.core.Keyword(null,"center-node","center-node",2639619052));return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"cx","cx",1013907431),new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(center_node),new cljs.core.Keyword(null,"cy","cy",1013907432),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(center_node),new cljs.core.Keyword(null,"r","r",1013904356),playfair_cljs.math.distance_formula.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(top_node),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(top_node)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(center_node),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(center_node)], null))], null);
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"line","line",1017226086)))
{var map__12783 = node_map;var map__12783__$1 = ((cljs.core.seq_QMARK_.call(null,map__12783))?cljs.core.apply.call(null,cljs.core.hash_map,map__12783):map__12783);var last_point = cljs.core.get.call(null,map__12783__$1,new cljs.core.Keyword(null,"last-point","last-point",1861953291));var first_point = cljs.core.get.call(null,map__12783__$1,new cljs.core.Keyword(null,"first-point","first-point",3184094117));return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x1","x1",1013908011),new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(first_point),new cljs.core.Keyword(null,"y1","y1",1013908042),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(first_point),new cljs.core.Keyword(null,"x2","x2",1013908012),new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(last_point),new cljs.core.Keyword(null,"y2","y2",1013908043),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(last_point)], null);
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"path","path",1017337751)))
{return new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"d","d",1013904342),cljs.core.reduce.call(null,(function (accum,p__12784){var vec__12785 = p__12784;var p_type = cljs.core.nth.call(null,vec__12785,0,null);var x = cljs.core.nth.call(null,vec__12785,1,null);var y = cljs.core.nth.call(null,vec__12785,2,null);return [cljs.core.str(accum),cljs.core.str(((cljs.core._EQ_.call(null,accum,""))?"":" ")),cljs.core.str(p_type),cljs.core.str(" "),cljs.core.str(x),cljs.core.str(" "),cljs.core.str(y)].join('');
}),"",node_map)], null);
} else
{return null;
}
}
}
}
});
playfair_cljs.shapes.vector_to_nodes = (function vector_to_nodes(shape_key,p__12786,p__12787){var vec__12790 = p__12786;var x1 = cljs.core.nth.call(null,vec__12790,0,null);var y1 = cljs.core.nth.call(null,vec__12790,1,null);var vec__12791 = p__12787;var x2 = cljs.core.nth.call(null,vec__12791,0,null);var y2 = cljs.core.nth.call(null,vec__12791,1,null);if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"rect","rect",1017400662)))
{return playfair_cljs.shapes.attrs_to_nodes.call(null,shape_key,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),(function (){var x__3755__auto__ = x1;var y__3756__auto__ = x2;return ((x__3755__auto__ < y__3756__auto__) ? x__3755__auto__ : y__3756__auto__);
})(),new cljs.core.Keyword(null,"y","y",1013904363),(function (){var x__3755__auto__ = y1;var y__3756__auto__ = y2;return ((x__3755__auto__ < y__3756__auto__) ? x__3755__auto__ : y__3756__auto__);
})(),new cljs.core.Keyword(null,"height","height",4087841945),Math.abs.call(null,(y1 - y2)),new cljs.core.Keyword(null,"width","width",1127031096),Math.abs.call(null,(x1 - x2))], null));
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"circle","circle",3948654658)))
{var mid_point = playfair_cljs.math.midpoint_formula.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x1,y1], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x2,y2], null));var top_node = playfair_cljs.shapes.rotate_point_around_point.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [mid_point.call(null,0),mid_point.call(null,1)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x1,y1], null),.25);var bottom_node = playfair_cljs.shapes.rotate_point_around_point.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [mid_point.call(null,0),mid_point.call(null,1)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x2,y2], null),.25);return new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"top-node","top-node",4296511212),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),top_node.call(null,0),new cljs.core.Keyword(null,"y","y",1013904363),top_node.call(null,1)], null),new cljs.core.Keyword(null,"center-node","center-node",2639619052),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),mid_point.call(null,0),new cljs.core.Keyword(null,"y","y",1013904363),mid_point.call(null,1)], null),new cljs.core.Keyword(null,"bottom-node","bottom-node",4653566934),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),bottom_node.call(null,0),new cljs.core.Keyword(null,"y","y",1013904363),bottom_node.call(null,1)], null),new cljs.core.Keyword(null,"left-node","left-node",2709524346),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x1,new cljs.core.Keyword(null,"y","y",1013904363),y1], null),new cljs.core.Keyword(null,"right-node","right-node",3874878085),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x2,new cljs.core.Keyword(null,"y","y",1013904363),y2], null)], null);
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"line","line",1017226086)))
{return playfair_cljs.shapes.attrs_to_nodes.call(null,shape_key,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x1","x1",1013908011),x1,new cljs.core.Keyword(null,"y1","y1",1013908042),y1,new cljs.core.Keyword(null,"x2","x2",1013908012),x2,new cljs.core.Keyword(null,"y2","y2",1013908043),y2], null));
} else
{if(cljs.core._EQ_.call(null,shape_key,new cljs.core.Keyword(null,"path","path",1017337751)))
{return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"type","type",1017479852),"M",new cljs.core.Keyword(null,"x","x",1013904362),x1,new cljs.core.Keyword(null,"y","y",1013904363),y1], null)], null);
} else
{return null;
}
}
}
}
});
playfair_cljs.shapes.attrs_to_vectors = (function attrs_to_vectors(shape_key,attrs){var vector_nodes = ((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"rect","rect",1017400662),shape_key))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098),new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015)], null):((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"circle","circle",3948654658),shape_key))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"left-node","left-node",2709524346),new cljs.core.Keyword(null,"right-node","right-node",3874878085)], null):((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"line","line",1017226086),shape_key))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.Keyword(null,"last-point","last-point",1861953291)], null):null)));var nodes = playfair_cljs.shapes.attrs_to_nodes.call(null,shape_key,attrs);var p1 = vector_nodes.call(null,0).call(null,nodes);var p2 = vector_nodes.call(null,1).call(null,nodes);return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(p1),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(p1)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(p2),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(p2)], null)], null);
});
playfair_cljs.shapes.vectors_to_attrs = (function vectors_to_attrs(shape_key,p__12792,p__12793){var vec__12796 = p__12792;var x1 = cljs.core.nth.call(null,vec__12796,0,null);var y1 = cljs.core.nth.call(null,vec__12796,1,null);var vec__12797 = p__12793;var x2 = cljs.core.nth.call(null,vec__12797,0,null);var y2 = cljs.core.nth.call(null,vec__12797,1,null);return playfair_cljs.shapes.nodes_to_attrs.call(null,shape_key,playfair_cljs.shapes.vector_to_nodes.call(null,shape_key,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x1,y1], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x2,y2], null)));
});
playfair_cljs.shapes.get_opposite_node = (function get_opposite_node(node_key){return node_key.call(null,cljs.core.PersistentHashMap.fromArrays([new cljs.core.Keyword(null,"top-node","top-node",4296511212),new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098),new cljs.core.Keyword(null,"right-node","right-node",3874878085),new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837),new cljs.core.Keyword(null,"left-node","left-node",2709524346),new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984),new cljs.core.Keyword(null,"bottom-node","bottom-node",4653566934),new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.Keyword(null,"bottom-center-node","bottom-center-node",2609391434),new cljs.core.Keyword(null,"top-center-node","top-center-node",4151893876),new cljs.core.Keyword(null,"middle-left-node","middle-left-node",3682637122),new cljs.core.Keyword(null,"middle-right-node","middle-right-node",3976603069),new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015),new cljs.core.Keyword(null,"last-point","last-point",1861953291)],[new cljs.core.Keyword(null,"bottom-node","bottom-node",4653566934),new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015),new cljs.core.Keyword(null,"left-node","left-node",2709524346),new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984),new cljs.core.Keyword(null,"right-node","right-node",3874878085),new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837),new cljs.core.Keyword(null,"top-node","top-node",4296511212),new cljs.core.Keyword(null,"last-point","last-point",1861953291),new cljs.core.Keyword(null,"top-center-node","top-center-node",4151893876),new cljs.core.Keyword(null,"bottom-center-node","bottom-center-node",2609391434),new cljs.core.Keyword(null,"middle-right-node","middle-right-node",3976603069),new cljs.core.Keyword(null,"middle-left-node","middle-left-node",3682637122),new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098),new cljs.core.Keyword(null,"first-point","first-point",3184094117)]));
});
playfair_cljs.shapes.node_radius = 5;
playfair_cljs.shapes.make_node = (function make_node(x,y,n_name,vis_attrs,shape_lookup,from_node){return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"shape-name","shape-name",1699536041),new cljs.core.Keyword(null,"circle","circle",3948654658),new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),playfair_cljs.shapes.attrs_to_nodes.call(null,new cljs.core.Keyword(null,"circle","circle",3948654658),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"cx","cx",1013907431),x,new cljs.core.Keyword(null,"cy","cy",1013907432),y,new cljs.core.Keyword(null,"r","r",1013904356),playfair_cljs.shapes.node_radius], null)),new cljs.core.Keyword(null,"visual-attrs","visual-attrs",1512932167),cljs.core.assoc.call(null,vis_attrs,new cljs.core.Keyword(null,"onMouseDown","onMouseDown",1569008442),(function (p1__12798_SHARP_){return cljs.core.async.put_BANG_.call(null,playfair_cljs.shapes.canvas_chan,new cljs.core.PersistentArrayMap(null, 5, [new cljs.core.Keyword(null,"e-type","e-type",3950582548),new cljs.core.Keyword(null,"mouseDown","mouseDown",1599794777),new cljs.core.Keyword(null,"e","e",1013904343),p1__12798_SHARP_.nativeEvent,new cljs.core.Keyword(null,"reciever","reciever",4503726569),new cljs.core.Keyword(null,"node","node",1017291124),new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872),shape_lookup,new cljs.core.Keyword(null,"from-node","from-node",1048241591),from_node], null));
})),new cljs.core.Keyword(null,"active","active",3885920888),null], null);
});
playfair_cljs.shapes.add_nodes = (function add_nodes(shape,vis_attr,shape_lookup){return cljs.core.conj.call(null,cljs.core.map.call(null,(function (p__12802){var vec__12803 = p__12802;var node_name = cljs.core.nth.call(null,vec__12803,0,null);var map__12804 = cljs.core.nth.call(null,vec__12803,1,null);var map__12804__$1 = ((cljs.core.seq_QMARK_.call(null,map__12804))?cljs.core.apply.call(null,cljs.core.hash_map,map__12804):map__12804);var y = cljs.core.get.call(null,map__12804__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12804__$1,new cljs.core.Keyword(null,"x","x",1013904362));return playfair_cljs.shapes.make_node.call(null,x,y,node_name,vis_attr,shape_lookup,node_name);
}),new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)),shape);
});
playfair_cljs.shapes.check_nodes = (function check_nodes(cs,key_state){return cljs.core.reduce.call(null,cljs.core.concat,cljs.core.reduce.call(null,cljs.core.concat,cljs.core.map.call(null,(function (p__12807){var vec__12808 = p__12807;var shape_name = cljs.core.nth.call(null,vec__12808,0,null);var shape_vec = cljs.core.nth.call(null,vec__12808,1,null);return cljs.core.map_indexed.call(null,(function (index,shape){if((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"select","select",4402849902),key_state)) && (cljs.core.not.call(null,new cljs.core.Keyword(null,"in-progress?","in-progress?",4659674236).cljs$core$IFn$_invoke$arity$1(cljs.core.deref.call(null,playfair_cljs.appstate.gui_state)))))
{if(cljs.core.truth_(new cljs.core.Keyword(null,"active","active",3885920888).cljs$core$IFn$_invoke$arity$1(shape)))
{return playfair_cljs.shapes.add_nodes.call(null,shape,playfair_cljs.shapes.regular_node_vis,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_name,index], null));
} else
{return cljs.core._conj.call(null,cljs.core.List.EMPTY,shape);
}
} else
{if(cljs.core.truth_(new cljs.core.Keyword(null,"active","active",3885920888).cljs$core$IFn$_invoke$arity$1(shape)))
{return playfair_cljs.shapes.add_nodes.call(null,shape,playfair_cljs.shapes.active_node_vis,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_name,index], null));
} else
{return playfair_cljs.shapes.add_nodes.call(null,shape,playfair_cljs.shapes.snap_node_vis,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_name,index], null));
}
}
}),shape_vec);
}),cs)));
});
playfair_cljs.shapes.scale_rect = (function scale_rect(node_name,shape,scale_val){var old_x = new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape));var old_y = new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape));var new_width = (scale_val * new cljs.core.Keyword(null,"width","width",1127031096).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)));var new_height = (scale_val * new cljs.core.Keyword(null,"height","height",4087841945).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)));var opp_node = playfair_cljs.shapes.get_opposite_node.call(null,node_name);var opp_node_pos = opp_node.call(null,playfair_cljs.shapes.attrs_to_nodes.call(null,new cljs.core.Keyword(null,"rect","rect",1017400662),new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)));var new_attrs = ((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),old_y,new cljs.core.Keyword(null,"width","width",1127031096),new_width,new cljs.core.Keyword(null,"height","height",4087841945),new_height], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"middle-left-node","middle-left-node",3682637122)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),old_y,new cljs.core.Keyword(null,"width","width",1127031096),new_width,new cljs.core.Keyword(null,"height","height",4087841945),new cljs.core.Keyword(null,"height","height",4087841945).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape))], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_node_pos) - new_height),new cljs.core.Keyword(null,"height","height",4087841945),new_height,new cljs.core.Keyword(null,"width","width",1127031096),new_width], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_node_pos) + new_height),new cljs.core.Keyword(null,"width","width",1127031096),new_width,new cljs.core.Keyword(null,"height","height",4087841945),new_height], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"middle-right-node","middle-right-node",3976603069)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),(new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(opp_node_pos) - new_width),new cljs.core.Keyword(null,"y","y",1013904363),old_y,new cljs.core.Keyword(null,"width","width",1127031096),new_width,new cljs.core.Keyword(null,"height","height",4087841945),new cljs.core.Keyword(null,"height","height",4087841945).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape))], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),(new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(opp_node_pos) - new_width),new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_node_pos) - new_height),new cljs.core.Keyword(null,"width","width",1127031096),new_width,new cljs.core.Keyword(null,"height","height",4087841945),new_height], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"top-center-node","top-center-node",4151893876)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_node_pos) + new_height),new cljs.core.Keyword(null,"width","width",1127031096),new cljs.core.Keyword(null,"width","width",1127031096).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)),new cljs.core.Keyword(null,"height","height",4087841945),new_height], null):((cljs.core._EQ_.call(null,opp_node,new cljs.core.Keyword(null,"bottom-center-node","bottom-center-node",2609391434)))?new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),old_x,new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_node_pos) - new_height),new cljs.core.Keyword(null,"width","width",1127031096),new cljs.core.Keyword(null,"width","width",1127031096).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)),new cljs.core.Keyword(null,"height","height",4087841945),new_height], null):null))))))));return playfair_cljs.shapes.attrs_to_nodes.call(null,new cljs.core.Keyword(null,"shape-name","shape-name",1699536041).cljs$core$IFn$_invoke$arity$1(shape),new_attrs);
});
playfair_cljs.shapes.scale_circle = (function scale_circle(node_name,shape,scale_val){return playfair_cljs.shapes.attrs_to_nodes.call(null,new cljs.core.Keyword(null,"shape-name","shape-name",1699536041).cljs$core$IFn$_invoke$arity$1(shape),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"cx","cx",1013907431),new cljs.core.Keyword(null,"cx","cx",1013907431).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)),new cljs.core.Keyword(null,"cy","cy",1013907432),new cljs.core.Keyword(null,"cy","cy",1013907432).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)),new cljs.core.Keyword(null,"r","r",1013904356),(scale_val * new cljs.core.Keyword(null,"r","r",1013904356).cljs$core$IFn$_invoke$arity$1(new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape)))], null));
});
playfair_cljs.shapes.scale_line = (function scale_line(clicked_node,p__12809,scale_val){var map__12811 = p__12809;var map__12811__$1 = ((cljs.core.seq_QMARK_.call(null,map__12811))?cljs.core.apply.call(null,cljs.core.hash_map,map__12811):map__12811);var position_attrs = cljs.core.get.call(null,map__12811__$1,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296));var around_p = playfair_cljs.shapes.get_opposite_node.call(null,clicked_node).call(null,position_attrs);var opp_p = clicked_node.call(null,position_attrs);var s_diffX = ((new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(around_p) - new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(opp_p)) * scale_val);var s_diffY = ((new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(around_p) - new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(opp_p)) * scale_val);var s_opp_p = new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(around_p) - s_diffX),new cljs.core.Keyword(null,"y","y",1013904363),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(around_p) - s_diffY)], null);return new cljs.core.PersistentArrayMap.fromArray([playfair_cljs.shapes.get_opposite_node.call(null,clicked_node),around_p,clicked_node,s_opp_p,new cljs.core.Keyword(null,"middle-point","middle-point",4048024266),playfair_cljs.math.map_midpoint_formula.call(null,around_p,s_opp_p)], true, false);
});
playfair_cljs.shapes.contain_str = (function contain_str(string,lookup){return (string.indexOf(lookup) >= 0);
});
playfair_cljs.shapes.canvas_state_to_nodes = (function canvas_state_to_nodes(canvas_state,p__12812){var vec__12815 = p__12812;var shape_key = cljs.core.nth.call(null,vec__12815,0,null);var index = cljs.core.nth.call(null,vec__12815,1,null);var map__12816 = shape_key.call(null,canvas_state).call(null,index);var map__12816__$1 = ((cljs.core.seq_QMARK_.call(null,map__12816))?cljs.core.apply.call(null,cljs.core.hash_map,map__12816):map__12816);var position_attrs = cljs.core.get.call(null,map__12816__$1,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296));var shape_name = cljs.core.get.call(null,map__12816__$1,new cljs.core.Keyword(null,"shape-name","shape-name",1699536041));return playfair_cljs.shapes.attrs_to_nodes.call(null,shape_name,position_attrs);
});
playfair_cljs.shapes.line_point_func = (function line_point_func(x,y){var cross_size = 5;var point = playfair_cljs.shapes.vector_to_nodes.call(null,new cljs.core.Keyword(null,"path","path",1017337751),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [0,0], null));var p_x = new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(point.call(null,0));var p_y = new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(point.call(null,0));return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"shape-name","shape-name",1699536041),"line",new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(p_x + cross_size),new cljs.core.Keyword(null,"y","y",1013904363),(p_y + cross_size)], null),new cljs.core.Keyword(null,"middle-point","middle-point",4048024266),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),p_x,new cljs.core.Keyword(null,"y","y",1013904363),p_y], null),new cljs.core.Keyword(null,"last-point","last-point",1861953291),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(p_x - cross_size),new cljs.core.Keyword(null,"y","y",1013904363),(p_y - cross_size)], null)], null),new cljs.core.Keyword(null,"visual-attrs","visual-attrs",1512932167),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"stroke","stroke",4416891306),"blue",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null),new cljs.core.Keyword(null,"active","active",3885920888),false], null),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"shape-name","shape-name",1699536041),"line",new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"first-point","first-point",3184094117),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(p_x - cross_size),new cljs.core.Keyword(null,"y","y",1013904363),(p_y + cross_size)], null),new cljs.core.Keyword(null,"middle-point","middle-point",4048024266),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),p_x,new cljs.core.Keyword(null,"y","y",1013904363),p_y], null),new cljs.core.Keyword(null,"last-point","last-point",1861953291),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(p_x + cross_size),new cljs.core.Keyword(null,"y","y",1013904363),(p_y - cross_size)], null)], null),new cljs.core.Keyword(null,"visual-attrs","visual-attrs",1512932167),new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"stroke","stroke",4416891306),"blue",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null),new cljs.core.Keyword(null,"active","active",3885920888),false], null)], null);
});
playfair_cljs.shapes.get_snap_name = (function get_snap_name(snap_vec){if((snap_vec instanceof cljs.core.Keyword))
{return cljs.core.name.call(null,snap_vec);
} else
{return [cljs.core.str(cljs.core.name.call(null,snap_vec.call(null,0))),cljs.core.str(snap_vec.call(null,1))].join('');
}
});
playfair_cljs.shapes.center_vector = (function center_vector(p__12817,p__12818){var vec__12821 = p__12817;var x = cljs.core.nth.call(null,vec__12821,0,null);var y = cljs.core.nth.call(null,vec__12821,1,null);var vec__12822 = p__12818;var diffX = cljs.core.nth.call(null,vec__12822,0,null);var diffY = cljs.core.nth.call(null,vec__12822,1,null);return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x + diffX),(y + diffY)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x - diffX),(y - diffY)], null)], null);
});
playfair_cljs.shapes.canvas_nodes = playfair_cljs.shapes.get_rect_node_points.call(null,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x","x",1013904362),0,new cljs.core.Keyword(null,"y","y",1013904363),0,new cljs.core.Keyword(null,"width","width",1127031096),playfair_cljs.shapes.canvas_size.call(null,0),new cljs.core.Keyword(null,"height","height",4087841945),playfair_cljs.shapes.canvas_size.call(null,1)], null));
playfair_cljs.shapes.shape_keys = new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"rect","rect",1017400662),new cljs.core.Keyword(null,"path","path",1017337751),new cljs.core.Keyword(null,"circle","circle",3948654658),new cljs.core.Keyword(null,"line","line",1017226086)], null);
playfair_cljs.shapes.glomp_line = (function glomp_line(pos_attrs,perc){return new cljs.core.Keyword(null,"last-point","last-point",1861953291).cljs$core$IFn$_invoke$arity$1(playfair_cljs.shapes.scale_line.call(null,new cljs.core.Keyword(null,"last-point","last-point",1861953291),new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),pos_attrs], null),perc));
});
playfair_cljs.shapes.vec_glomp_line = (function vec_glomp_line(p__12823,p__12824,perc){var vec__12827 = p__12823;var x1 = cljs.core.nth.call(null,vec__12827,0,null);var y1 = cljs.core.nth.call(null,vec__12827,1,null);var vec__12828 = p__12824;var x2 = cljs.core.nth.call(null,vec__12828,0,null);var y2 = cljs.core.nth.call(null,vec__12828,1,null);return playfair_cljs.shapes.glomp_line.call(null,playfair_cljs.shapes.attrs_to_nodes.call(null,new cljs.core.Keyword(null,"line","line",1017226086),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"x1","x1",1013908011),x1,new cljs.core.Keyword(null,"y1","y1",1013908042),y1,new cljs.core.Keyword(null,"x2","x2",1013908012),x2,new cljs.core.Keyword(null,"y2","y2",1013908043),y2], null)),perc);
});
playfair_cljs.shapes.get_length = (function get_length(seg_vecs){return cljs.core.reduce.call(null,(function (mag,p__12831){var vec__12832 = p__12831;var p1 = cljs.core.nth.call(null,vec__12832,0,null);var p2 = cljs.core.nth.call(null,vec__12832,1,null);return (mag + playfair_cljs.math.distance_formula.call(null,p1,p2));
}),0,seg_vecs);
});
playfair_cljs.shapes.make_seg_vecs = (function make_seg_vecs(points_vec){var f = cljs.core.first.call(null,points_vec);var l = cljs.core.last.call(null,points_vec);return cljs.core.vec.call(null,cljs.core.map.call(null,cljs.core.vec,cljs.core.partition.call(null,2,cljs.core.reduce.call(null,(function (accum,point){if((cljs.core._EQ_.call(null,point,f)) || (cljs.core._EQ_.call(null,point,l)))
{return cljs.core.conj.call(null,accum,point);
} else
{return cljs.core.conj.call(null,accum,point,point);
}
}),cljs.core.PersistentVector.EMPTY,points_vec))));
});
playfair_cljs.shapes.segment_glomper = (function segment_glomper(seg_vecs,g_val){var length = playfair_cljs.shapes.get_length.call(null,seg_vecs);var s_vecs = seg_vecs;var g_v = g_val;var t_dist = 0;while(true){
var vec__12834 = cljs.core.first.call(null,seg_vecs);var p1 = cljs.core.nth.call(null,vec__12834,0,null);var p2 = cljs.core.nth.call(null,vec__12834,1,null);var new_t_dist = (t_dist + playfair_cljs.math.distance_formula.call(null,p1,p2));if((new_t_dist > (g_v * length)))
{var new_g_val = ((t_dist / length) - g_val);if((new_g_val > 0))
{return playfair_cljs.shapes.vec_glomp_line.call(null,p1,p2,new_g_val);
} else
{return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),p1.call(null,0),new cljs.core.Keyword(null,"y","y",1013904363),p1.call(null,1)], null);
}
} else
{{
var G__12835 = cljs.core.next.call(null,s_vecs);
var G__12836 = g_v;
var G__12837 = new_t_dist;
s_vecs = G__12835;
g_v = G__12836;
t_dist = G__12837;
continue;
}
}
break;
}
});
playfair_cljs.shapes.glomp = (function glomp(s_key,pos_attrs,g_val){if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"rect","rect",1017400662),s_key))
{var map__12843 = pos_attrs;var map__12843__$1 = ((cljs.core.seq_QMARK_.call(null,map__12843))?cljs.core.apply.call(null,cljs.core.hash_map,map__12843):map__12843);var bottom_left_node = cljs.core.get.call(null,map__12843__$1,new cljs.core.Keyword(null,"bottom-left-node","bottom-left-node",4456976984));var bottom_right_node = cljs.core.get.call(null,map__12843__$1,new cljs.core.Keyword(null,"bottom-right-node","bottom-right-node",2211335015));var top_right_node = cljs.core.get.call(null,map__12843__$1,new cljs.core.Keyword(null,"top-right-node","top-right-node",875619837));var top_left_node = cljs.core.get.call(null,map__12843__$1,new cljs.core.Keyword(null,"top-left-node","top-left-node",534564098));var points_vec = cljs.core.map.call(null,((function (map__12843,map__12843__$1,bottom_left_node,bottom_right_node,top_right_node,top_left_node){
return (function (p__12844){var map__12845 = p__12844;var map__12845__$1 = ((cljs.core.seq_QMARK_.call(null,map__12845))?cljs.core.apply.call(null,cljs.core.hash_map,map__12845):map__12845);var y = cljs.core.get.call(null,map__12845__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12845__$1,new cljs.core.Keyword(null,"x","x",1013904362));return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null);
});})(map__12843,map__12843__$1,bottom_left_node,bottom_right_node,top_right_node,top_left_node))
,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [top_left_node,top_right_node,bottom_right_node,bottom_left_node], null));return playfair_cljs.shapes.segment_glomper.call(null,playfair_cljs.shapes.make_seg_vecs.call(null,points_vec),g_val);
} else
{if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"line","line",1017226086),s_key))
{return playfair_cljs.shapes.glomp_line.call(null,pos_attrs,g_val);
} else
{if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"path","path",1017337751),s_key))
{return playfair_cljs.shapes.segment_glomper.call(null,playfair_cljs.shapes.make_seg_vecs.call(null,cljs.core.map.call(null,(function (p__12846){var vec__12847 = p__12846;var t = cljs.core.nth.call(null,vec__12847,0,null);var x = cljs.core.nth.call(null,vec__12847,1,null);var y = cljs.core.nth.call(null,vec__12847,2,null);return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null);
}),pos_attrs)),g_val);
} else
{if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"circle","circle",3948654658),s_key))
{var r = new cljs.core.Keyword(null,"r","r",1013904356).cljs$core$IFn$_invoke$arity$1(playfair_cljs.shapes.nodes_to_attrs.call(null,new cljs.core.Keyword(null,"circle","circle",3948654658),pos_attrs));var radian = ((playfair_cljs.math.PI * 2) * g_val);return new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),(playfair_cljs.math.cos.call(null,radian) * r),new cljs.core.Keyword(null,"y","y",1013904363),(playfair_cljs.math.sin.call(null,radian) * r)], null);
} else
{return null;
}
}
}
}
});
playfair_cljs.shapes.snap = (function snap(cs,node,s_lookup){var map__12850 = ((cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"canvas","canvas",3941165258),s_lookup))?((typeof node === 'number')?playfair_cljs.shapes.glomp.call(null,new cljs.core.Keyword(null,"rect","rect",1017400662),playfair_cljs.shapes.canvas_nodes,node):node.call(null,playfair_cljs.shapes.canvas_nodes)):((typeof node === 'number')?playfair_cljs.shapes.glomp.call(null,s_lookup.call(null,0),cljs.core.get_in.call(null,cs,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [s_lookup.call(null,0),s_lookup.call(null,1),new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null)),node):((new cljs.core.Keyword(null,"else","else",1017020587))?(function (){var vec__12851 = s_lookup;var s_key = cljs.core.nth.call(null,vec__12851,0,null);var s_index = cljs.core.nth.call(null,vec__12851,1,null);return cljs.core.get_in.call(null,cs,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [s_key,s_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),node], null));
})():null)));var map__12850__$1 = ((cljs.core.seq_QMARK_.call(null,map__12850))?cljs.core.apply.call(null,cljs.core.hash_map,map__12850):map__12850);var y = cljs.core.get.call(null,map__12850__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12850__$1,new cljs.core.Keyword(null,"x","x",1013904362));return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null);
});
playfair_cljs.shapes.make_draw = (function() {
var make_draw = null;
var make_draw__3 = (function (shape_key,p__12852,p__12853){var vec__12860 = p__12852;var x = cljs.core.nth.call(null,vec__12860,0,null);var y = cljs.core.nth.call(null,vec__12860,1,null);var vec__12861 = p__12853;var diffX = cljs.core.nth.call(null,vec__12861,0,null);var diffY = cljs.core.nth.call(null,vec__12861,1,null);return make_draw.call(null,shape_key,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [diffX,diffY], null),null);
});
var make_draw__4 = (function (shape_key,p__12854,p__12855,options_vec){var vec__12862 = p__12854;var x = cljs.core.nth.call(null,vec__12862,0,null);var y = cljs.core.nth.call(null,vec__12862,1,null);var vec__12863 = p__12855;var diffX = cljs.core.nth.call(null,vec__12863,0,null);var diffY = cljs.core.nth.call(null,vec__12863,1,null);return cljs.core.conj.call(null,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"draw","draw",1016996022),new cljs.core.Keyword(null,"shape","shape",1123304211),shape_key], null),cljs.core.zipmap.call(null,(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,y))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"from-node","from-node",1048241591),new cljs.core.Keyword(null,"from-shape","from-shape",2082768688)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null)),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null)),cljs.core.zipmap.call(null,(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,diffY))?new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"to-node","to-node",4107897222),new cljs.core.Keyword(null,"to-shape","to-shape",2442812737)], null):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"diffX","diffX",1109485669),new cljs.core.Keyword(null,"diffY","diffY",1109485670)], null)),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [diffX,diffY], null)),(cljs.core.truth_(options_vec)?cljs.core.zipmap.call(null,options_vec,cljs.core.repeat.call(null,cljs.core.count.call(null,options_vec),true)):null));
});
make_draw = function(shape_key,p__12854,p__12855,options_vec){
switch(arguments.length){
case 3:
return make_draw__3.call(this,shape_key,p__12854,p__12855);
case 4:
return make_draw__4.call(this,shape_key,p__12854,p__12855,options_vec);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
make_draw.cljs$core$IFn$_invoke$arity$3 = make_draw__3;
make_draw.cljs$core$IFn$_invoke$arity$4 = make_draw__4;
return make_draw;
})()
;
playfair_cljs.shapes.make_scale = (function make_scale(shape_lookup,node,scale_val){return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"scale","scale",1123155132),new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872),shape_lookup,new cljs.core.Keyword(null,"node","node",1017291124),node,new cljs.core.Keyword(null,"scale-val","scale-val",3429794704),scale_val], null);
});
playfair_cljs.shapes.make_for = (function make_for(times,steps_vec){return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"for","for",1014005819),new cljs.core.Keyword(null,"times","times",1124268728),times,new cljs.core.Keyword(null,"for-steps","for-steps",1009839253),steps_vec], null);
});
playfair_cljs.shapes.make_rotate = (function make_rotate(shape_lookup,node,rotate_val){return new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"rotate","rotate",4383690957),new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872),shape_lookup,new cljs.core.Keyword(null,"node","node",1017291124),node,new cljs.core.Keyword(null,"rotate-val","rotate-val",934012705),rotate_val], null);
});
playfair_cljs.shapes.make_move = (function make_move(from_node,shape_lookup,diffX,diffY){return cljs.core.conj.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"move","move",1017261891),new cljs.core.Keyword(null,"from-node","from-node",1048241591),from_node,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872),shape_lookup], null),cljs.core.zipmap.call(null,(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,diffY))?new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"from-node","from-node",1048241591)], null):new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"diffX","diffX",1109485669)], null)),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [diffX], null)),(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,diffY))?new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"to-node","to-node",4107897222),diffY.call(null,0),new cljs.core.Keyword(null,"to-shape","to-shape",2442812737),diffY.call(null,1)], null):new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"diffY","diffY",1109485670),diffY], null)));
});
playfair_cljs.shapes.make_path_start = (function make_path_start(x,y,options_vec,vis_attrs){return cljs.core.conj.call(null,new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"path-start","path-start",761511980)], null),(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,y))?new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"from-node","from-node",1048241591),x,new cljs.core.Keyword(null,"from-shape","from-shape",2082768688),y], null):new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),x,new cljs.core.Keyword(null,"y","y",1013904363),y], null)),(cljs.core.truth_(options_vec)?cljs.core.zipmap.call(null,options_vec,cljs.core.repeat.call(null,cljs.core.count.call(null,options_vec),true)):null),(cljs.core.truth_(vis_attrs)?new cljs.core.PersistentArrayMap(null, 1, [new cljs.core.Keyword(null,"vis-attrs","vis-attrs",1159306279),vis_attrs], null):null));
});
playfair_cljs.shapes.make_path_extend = (function make_path_extend(path_index,p_type,n_x,n_y){return cljs.core.conj.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"step-name","step-name",2312562782),new cljs.core.Keyword(null,"path-extend","path-extend",1383118132),new cljs.core.Keyword(null,"path-index","path-index",752100508),path_index,new cljs.core.Keyword(null,"p-type","p-type",4265503209),p_type], null),(cljs.core.truth_(playfair_cljs.shapes.check_snap.call(null,n_y))?new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"to-shape","to-shape",2442812737),n_y,new cljs.core.Keyword(null,"to-node","to-node",4107897222),n_x], null):new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),n_x,new cljs.core.Keyword(null,"y","y",1013904363),n_y], null)));
});
playfair_cljs.shapes.conj_in = (function conj_in(x,lookup_vec,added_val){return cljs.core.assoc_in.call(null,x,lookup_vec,cljs.core.conj.call(null,cljs.core.get_in.call(null,x,lookup_vec),added_val));
});
playfair_cljs.shapes.default_shape_visual = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"fill","fill",1017047285),"#1F1E1D",new cljs.core.Keyword(null,"className","className",1004015509),"shape",new cljs.core.Keyword(null,"stroke","stroke",4416891306),"#1F1E1D",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),3], null);
playfair_cljs.shapes.guide_shape_visual = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"className","className",1004015509),"guide",new cljs.core.Keyword(null,"stroke","stroke",4416891306),"#225E79",new cljs.core.Keyword(null,"fill","fill",1017047285),"#3BA3D0",new cljs.core.Keyword(null,"strokeWidth","strokeWidth",2937970144),2], null);
playfair_cljs.shapes.make_draw_cs = (function make_draw_cs(canvas_state,p__12864){var map__12870 = p__12864;var map__12870__$1 = ((cljs.core.seq_QMARK_.call(null,map__12870))?cljs.core.apply.call(null,cljs.core.hash_map,map__12870):map__12870);var draw_map = map__12870__$1;var diffY = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"diffY","diffY",1109485670));var diffX = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"diffX","diffX",1109485669));var to_shape = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var to_node = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var y = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"x","x",1013904362));var from_shape = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"from-shape","from-shape",2082768688));var from_node = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var shape = cljs.core.get.call(null,map__12870__$1,new cljs.core.Keyword(null,"shape","shape",1123304211));var vec__12871 = (cljs.core.truth_(from_node)?playfair_cljs.shapes.snap.call(null,canvas_state,from_node,from_shape):new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x,y], null));var x__$1 = cljs.core.nth.call(null,vec__12871,0,null);var y__$1 = cljs.core.nth.call(null,vec__12871,1,null);var vec__12872 = (function (){var vec__12873 = (cljs.core.truth_(to_node)?(function (){var vec__12874 = playfair_cljs.shapes.snap.call(null,canvas_state,to_node,to_shape);var x2 = cljs.core.nth.call(null,vec__12874,0,null);var y2 = cljs.core.nth.call(null,vec__12874,1,null);return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x2 - x__$1),(y2 - y__$1)], null);
})():new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [diffX,diffY], null));var d_X = cljs.core.nth.call(null,vec__12873,0,null);var d_Y = cljs.core.nth.call(null,vec__12873,1,null);if(cljs.core.truth_(new cljs.core.Keyword(null,"horizontally","horizontally",3086095395).cljs$core$IFn$_invoke$arity$1(draw_map)))
{return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [d_X,0], null);
} else
{if(cljs.core.truth_(new cljs.core.Keyword(null,"vertically","vertically",1219453685).cljs$core$IFn$_invoke$arity$1(draw_map)))
{return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [0,d_Y], null);
} else
{if(new cljs.core.Keyword(null,"else","else",1017020587))
{return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [d_X,d_Y], null);
} else
{return null;
}
}
}
})();var diffX__$1 = cljs.core.nth.call(null,vec__12872,0,null);var diffY__$1 = cljs.core.nth.call(null,vec__12872,1,null);var pos_attrs = (cljs.core.truth_(new cljs.core.Keyword(null,"centered","centered",4456450854).cljs$core$IFn$_invoke$arity$1(draw_map))?playfair_cljs.shapes.vector_to_nodes.call(null,shape,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x__$1 + diffX__$1),(y__$1 + diffY__$1)], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x__$1 - diffX__$1),(y__$1 - diffY__$1)], null)):playfair_cljs.shapes.vector_to_nodes.call(null,shape,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [x__$1,y__$1], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(x__$1 + diffX__$1),(y__$1 + diffY__$1)], null)));return playfair_cljs.shapes.conj_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape], null),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"shape-name","shape-name",1699536041),shape,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),pos_attrs,new cljs.core.Keyword(null,"visual-attrs","visual-attrs",1512932167),cljs.core.conj.call(null,playfair_cljs.shapes.default_shape_visual,(cljs.core.truth_(new cljs.core.Keyword(null,"guide","guide",1112616558).cljs$core$IFn$_invoke$arity$1(draw_map))?playfair_cljs.shapes.guide_shape_visual:new cljs.core.Keyword(null,"vis-attrs","vis-attrs",1159306279).cljs$core$IFn$_invoke$arity$1(draw_map))),new cljs.core.Keyword(null,"active","active",3885920888),new cljs.core.Keyword(null,"active","active",3885920888).cljs$core$IFn$_invoke$arity$1(draw_map)], null));
});
playfair_cljs.shapes.start_path_cs = (function start_path_cs(canvas_state,p__12875){var map__12878 = p__12875;var map__12878__$1 = ((cljs.core.seq_QMARK_.call(null,map__12878))?cljs.core.apply.call(null,cljs.core.hash_map,map__12878):map__12878);var s_path = map__12878__$1;var vis_attrs = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"vis-attrs","vis-attrs",1159306279));var from_shape = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"from-shape","from-shape",2082768688));var from_node = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var y = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"x","x",1013904362));var step_name = cljs.core.get.call(null,map__12878__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));return playfair_cljs.shapes.conj_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path","path",1017337751)], null),new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"shape-name","shape-name",1699536041),new cljs.core.Keyword(null,"path","path",1017337751),new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),(cljs.core.truth_(from_shape)?(function (){var vec__12879 = from_shape;var s_key = cljs.core.nth.call(null,vec__12879,0,null);var s_index = cljs.core.nth.call(null,vec__12879,1,null);var snap_point = cljs.core.get_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [s_key,s_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296),from_node], null));return new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["M",new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(snap_point),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(snap_point)], null)], null);
})():new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, ["M",x,y], null)], null)),new cljs.core.Keyword(null,"visual-attrs","visual-attrs",1512932167),cljs.core.conj.call(null,(cljs.core.truth_(new cljs.core.Keyword(null,"guide","guide",1112616558).cljs$core$IFn$_invoke$arity$1(s_path))?playfair_cljs.shapes.guide_shape_visual:playfair_cljs.shapes.default_shape_visual),vis_attrs),new cljs.core.Keyword(null,"active","active",3885920888),new cljs.core.Keyword(null,"active","active",3885920888).cljs$core$IFn$_invoke$arity$1(s_path)], null));
});
playfair_cljs.shapes.extend_path_cs = (function extend_path_cs(canvas_state,p__12880){var map__12883 = p__12880;var map__12883__$1 = ((cljs.core.seq_QMARK_.call(null,map__12883))?cljs.core.apply.call(null,cljs.core.hash_map,map__12883):map__12883);var to_node = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var to_shape = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var y = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"x","x",1013904362));var p_type = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"p-type","p-type",4265503209));var path_index = cljs.core.get.call(null,map__12883__$1,new cljs.core.Keyword(null,"path-index","path-index",752100508));return playfair_cljs.shapes.conj_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"path","path",1017337751),path_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),(cljs.core.truth_(to_shape)?(function (){var vec__12884 = playfair_cljs.shapes.snap.call(null,canvas_state,to_node,to_shape);var x__$1 = cljs.core.nth.call(null,vec__12884,0,null);var y__$1 = cljs.core.nth.call(null,vec__12884,1,null);return new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [p_type,x__$1,y__$1], null);
})():new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [p_type,x,y], null)));
});
playfair_cljs.shapes.s_lookup_txt = (function s_lookup_txt(s_lookup){if(cljs.core._EQ_.call(null,new cljs.core.Keyword(null,"canvas","canvas",3941165258),s_lookup))
{return "canvas";
} else
{return [cljs.core.str(cljs.core.name.call(null,s_lookup.call(null,0))),cljs.core.str(s_lookup.call(null,1))].join('');
}
});
playfair_cljs.shapes.draw_text = (function draw_text(p__12885){var map__12887 = p__12885;var map__12887__$1 = ((cljs.core.seq_QMARK_.call(null,map__12887))?cljs.core.apply.call(null,cljs.core.hash_map,map__12887):map__12887);var diffY = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"diffY","diffY",1109485670));var diffX = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"diffX","diffX",1109485669));var to_shape = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var to_node = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var y = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"x","x",1013904362));var from_shape = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"from-shape","from-shape",2082768688));var from_node = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var shape = cljs.core.get.call(null,map__12887__$1,new cljs.core.Keyword(null,"shape","shape",1123304211));var dec_places = 1;return [cljs.core.str("Draw "),cljs.core.str(cljs.core.name.call(null,shape)),cljs.core.str((cljs.core.truth_(from_node)?[cljs.core.str(" at "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,from_shape)),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,from_node)),cljs.core.str(" ")].join(''):[cljs.core.str(" from ("),cljs.core.str(playfair_cljs.math.round.call(null,x,dec_places)),cljs.core.str(", "),cljs.core.str(playfair_cljs.math.round.call(null,y,dec_places)),cljs.core.str(") ")].join(''))),cljs.core.str((cljs.core.truth_(to_node)?[cljs.core.str("to "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,to_shape)),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,to_node))].join(''):[cljs.core.str(playfair_cljs.math.round.call(null,diffX,dec_places)),cljs.core.str("px horizontally "),cljs.core.str(playfair_cljs.math.round.call(null,diffY,dec_places)),cljs.core.str("px vertically")].join('')))].join('');
});
playfair_cljs.shapes.make_scale_cs = (function make_scale_cs(canvas_state,p__12888){var map__12892 = p__12888;var map__12892__$1 = ((cljs.core.seq_QMARK_.call(null,map__12892))?cljs.core.apply.call(null,cljs.core.hash_map,map__12892):map__12892);var scale_val = cljs.core.get.call(null,map__12892__$1,new cljs.core.Keyword(null,"scale-val","scale-val",3429794704));var node = cljs.core.get.call(null,map__12892__$1,new cljs.core.Keyword(null,"node","node",1017291124));var shape_lookup = cljs.core.get.call(null,map__12892__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));var step_name = cljs.core.get.call(null,map__12892__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));var vec__12893 = shape_lookup;var shape_key = cljs.core.nth.call(null,vec__12893,0,null);var shape_index = cljs.core.nth.call(null,vec__12893,1,null);var shape_map = shape_key.call(null,canvas_state).call(null,shape_index);var map__12894 = cljs.core.assoc_in.call(null,shape_map,new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),playfair_cljs.shapes.nodes_to_attrs.call(null,shape_key,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape_map)));var map__12894__$1 = ((cljs.core.seq_QMARK_.call(null,map__12894))?cljs.core.apply.call(null,cljs.core.hash_map,map__12894):map__12894);var shape = map__12894__$1;var shape_name = cljs.core.get.call(null,map__12894__$1,new cljs.core.Keyword(null,"shape-name","shape-name",1699536041));return shape_name.call(null,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"rect","rect",1017400662),cljs.core.assoc_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,shape_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),playfair_cljs.shapes.scale_rect.call(null,node,shape,scale_val)),new cljs.core.Keyword(null,"circle","circle",3948654658),cljs.core.assoc_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,shape_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),playfair_cljs.shapes.scale_circle.call(null,node,shape,scale_val)),new cljs.core.Keyword(null,"line","line",1017226086),cljs.core.assoc_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,shape_index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),playfair_cljs.shapes.scale_line.call(null,node,shape_map,scale_val))], null));
});
playfair_cljs.shapes.scale_text = (function scale_text(p__12895){var map__12898 = p__12895;var map__12898__$1 = ((cljs.core.seq_QMARK_.call(null,map__12898))?cljs.core.apply.call(null,cljs.core.hash_map,map__12898):map__12898);var scale_val = cljs.core.get.call(null,map__12898__$1,new cljs.core.Keyword(null,"scale-val","scale-val",3429794704));var node = cljs.core.get.call(null,map__12898__$1,new cljs.core.Keyword(null,"node","node",1017291124));var shape_lookup = cljs.core.get.call(null,map__12898__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));var step_name = cljs.core.get.call(null,map__12898__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));var vec__12899 = shape_lookup;var shape_key = cljs.core.nth.call(null,vec__12899,0,null);var shape_index = cljs.core.nth.call(null,vec__12899,1,null);return [cljs.core.str("Scale "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,shape_index], null))),cljs.core.str(" around "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,shape_index], null))),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,playfair_cljs.shapes.get_opposite_node.call(null,node))),cljs.core.str(" by "),cljs.core.str(scale_val)].join('');
});
playfair_cljs.shapes.make_rotate_cs = (function make_rotate_cs(canvas_state,p__12900){var map__12906 = p__12900;var map__12906__$1 = ((cljs.core.seq_QMARK_.call(null,map__12906))?cljs.core.apply.call(null,cljs.core.hash_map,map__12906):map__12906);var rotate_val = cljs.core.get.call(null,map__12906__$1,new cljs.core.Keyword(null,"rotate-val","rotate-val",934012705));var node = cljs.core.get.call(null,map__12906__$1,new cljs.core.Keyword(null,"node","node",1017291124));var shape_lookup = cljs.core.get.call(null,map__12906__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));var vec__12907 = shape_lookup;var shape_key = cljs.core.nth.call(null,vec__12907,0,null);var index = cljs.core.nth.call(null,vec__12907,1,null);var rotated_canvas_state = cljs.core.assoc_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),cljs.core.reduce.call(null,((function (vec__12907,shape_key,index){
return (function (accum,p__12908){var vec__12909 = p__12908;var node_name = cljs.core.nth.call(null,vec__12909,0,null);var node_pos = cljs.core.nth.call(null,vec__12909,1,null);var shape_pos = new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(shape_key.call(null,canvas_state).call(null,index));var vec__12910 = playfair_cljs.shapes.rotate_point_around_point.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(node.call(null,shape_pos)),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(node.call(null,shape_pos))], null),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(node_pos),new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(node_pos)], null),rotate_val);var new_x = cljs.core.nth.call(null,vec__12910,0,null);var new_y = cljs.core.nth.call(null,vec__12910,1,null);return cljs.core.assoc.call(null,accum,node_name,new cljs.core.PersistentArrayMap(null, 2, [new cljs.core.Keyword(null,"x","x",1013904362),new_x,new cljs.core.Keyword(null,"y","y",1013904363),new_y], null));
});})(vec__12907,shape_key,index))
,cljs.core.PersistentArrayMap.EMPTY,cljs.core.vec.call(null,cljs.core.get_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null)))));return rotated_canvas_state;
});
playfair_cljs.shapes.rotate_text = (function rotate_text(p__12911){var map__12914 = p__12911;var map__12914__$1 = ((cljs.core.seq_QMARK_.call(null,map__12914))?cljs.core.apply.call(null,cljs.core.hash_map,map__12914):map__12914);var rotate_val = cljs.core.get.call(null,map__12914__$1,new cljs.core.Keyword(null,"rotate-val","rotate-val",934012705));var node = cljs.core.get.call(null,map__12914__$1,new cljs.core.Keyword(null,"node","node",1017291124));var shape_lookup = cljs.core.get.call(null,map__12914__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));var vec__12915 = shape_lookup;var shape_key = cljs.core.nth.call(null,vec__12915,0,null);var index = cljs.core.nth.call(null,vec__12915,1,null);return [cljs.core.str("Rotate "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,index], null))),cljs.core.str(" around "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,index], null))),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,playfair_cljs.shapes.get_opposite_node.call(null,node))),cljs.core.str(" by "),cljs.core.str(rotate_val)].join('');
});
playfair_cljs.shapes.path_start_text = (function path_start_text(p__12916){var map__12918 = p__12916;var map__12918__$1 = ((cljs.core.seq_QMARK_.call(null,map__12918))?cljs.core.apply.call(null,cljs.core.hash_map,map__12918):map__12918);var from_node = cljs.core.get.call(null,map__12918__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var from_shape = cljs.core.get.call(null,map__12918__$1,new cljs.core.Keyword(null,"from-shape","from-shape",2082768688));var y = cljs.core.get.call(null,map__12918__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12918__$1,new cljs.core.Keyword(null,"x","x",1013904362));return [cljs.core.str("Start path "),cljs.core.str((cljs.core.truth_(from_shape)?[cljs.core.str("at "),cljs.core.str(cljs.core.name.call(null,from_shape.call(null,0))),cljs.core.str(from_shape.call(null,1)),cljs.core.str("'s "),cljs.core.str(from_node)].join(''):[cljs.core.str(x),cljs.core.str("px horizontally "),cljs.core.str(y),cljs.core.str("px vertically")].join('')))].join('');
});
playfair_cljs.shapes.path_extend_text = (function path_extend_text(p__12919){var map__12921 = p__12919;var map__12921__$1 = ((cljs.core.seq_QMARK_.call(null,map__12921))?cljs.core.apply.call(null,cljs.core.hash_map,map__12921):map__12921);var to_node = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var to_shape = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var y = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"y","y",1013904363));var x = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"x","x",1013904362));var p_type = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"p-type","p-type",4265503209));var path_index = cljs.core.get.call(null,map__12921__$1,new cljs.core.Keyword(null,"path-index","path-index",752100508));var p_t_lookup = new cljs.core.PersistentArrayMap(null, 4, ["L","line","H","horizontal line","V","vertical line","C","cubic B\u00E9zier"], null);return [cljs.core.str("Extend path"),cljs.core.str(path_index),cljs.core.str(" with "),cljs.core.str(cljs.core.get.call(null,p_t_lookup,p_type)),cljs.core.str((cljs.core.truth_((function (){var and__3429__auto__ = to_shape;if(cljs.core.truth_(and__3429__auto__))
{return typeof to_node === 'number';
} else
{return and__3429__auto__;
}
})())?[cljs.core.str(" to "),cljs.core.str(to_node),cljs.core.str(" along "),cljs.core.str(playfair_cljs.shapes.s_lookup_txt.call(null,to_shape))].join(''):(cljs.core.truth_(to_shape)?[cljs.core.str(" to "),cljs.core.str(playfair_cljs.shapes.s_lookup_txt.call(null,to_shape)),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,to_node))].join(''):((new cljs.core.Keyword(null,"else","else",1017020587))?[cljs.core.str(x),cljs.core.str("px horizontally "),cljs.core.str(y),cljs.core.str("px vertically")].join(''):null))))].join('');
});
playfair_cljs.shapes.make_move_cs = (function make_move_cs(canvas_state,p__12922){var map__12928 = p__12922;var map__12928__$1 = ((cljs.core.seq_QMARK_.call(null,map__12928))?cljs.core.apply.call(null,cljs.core.hash_map,map__12928):map__12928);var diffY = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"diffY","diffY",1109485670));var diffX = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"diffX","diffX",1109485669));var to_shape = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var to_node = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var from_node = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var shape_lookup = cljs.core.get.call(null,map__12928__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));var vec__12929 = shape_lookup;var shape_key = cljs.core.nth.call(null,vec__12929,0,null);var index = cljs.core.nth.call(null,vec__12929,1,null);var map__12930 = shape_key.call(null,canvas_state).call(null,index);var map__12930__$1 = ((cljs.core.seq_QMARK_.call(null,map__12930))?cljs.core.apply.call(null,cljs.core.hash_map,map__12930):map__12930);var shape_name = cljs.core.get.call(null,map__12930__$1,new cljs.core.Keyword(null,"shape-name","shape-name",1699536041));var position_attrs = cljs.core.get.call(null,map__12930__$1,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296));var vec__12931 = (cljs.core.truth_(to_node)?(function (){var moved_node_pos = from_node.call(null,position_attrs);var vec__12932 = to_shape;var to_shape_key = cljs.core.nth.call(null,vec__12932,0,null);var to_index = cljs.core.nth.call(null,vec__12932,1,null);var snapped_shape_pos = to_node.call(null,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296).cljs$core$IFn$_invoke$arity$1(to_shape_key.call(null,canvas_state).call(null,to_index)));return new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [(new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(snapped_shape_pos) - new cljs.core.Keyword(null,"x","x",1013904362).cljs$core$IFn$_invoke$arity$1(moved_node_pos)),(new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(snapped_shape_pos) - new cljs.core.Keyword(null,"y","y",1013904363).cljs$core$IFn$_invoke$arity$1(moved_node_pos))], null);
})():new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [diffX,diffY], null));var diffX__$1 = cljs.core.nth.call(null,vec__12931,0,null);var diffY__$1 = cljs.core.nth.call(null,vec__12931,1,null);var shape_pos_attrs = playfair_cljs.shapes.nodes_to_attrs.call(null,shape_name,position_attrs);var positions = cljs.core.reduce.call(null,cljs.core.conj,cljs.core.map.call(null,((function (vec__12929,shape_key,index,map__12930,map__12930__$1,shape_name,position_attrs,vec__12931,diffX__$1,diffY__$1,shape_pos_attrs){
return (function (pos_attr){if(([cljs.core.str(pos_attr)].join('').indexOf("x") > 0))
{return new cljs.core.PersistentArrayMap.fromArray([pos_attr,(pos_attr.call(null,shape_pos_attrs) + diffX__$1)], true, false);
} else
{if(([cljs.core.str(pos_attr)].join('').indexOf("y") > 0))
{return new cljs.core.PersistentArrayMap.fromArray([pos_attr,(pos_attr.call(null,shape_pos_attrs) + diffY__$1)], true, false);
} else
{return null;
}
}
});})(vec__12929,shape_key,index,map__12930,map__12930__$1,shape_name,position_attrs,vec__12931,diffX__$1,diffY__$1,shape_pos_attrs))
,playfair_cljs.shapes.get_pos_key.call(null,shape_name)));return cljs.core.assoc_in.call(null,canvas_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [shape_key,index,new cljs.core.Keyword(null,"position-attrs","position-attrs",2552349296)], null),playfair_cljs.shapes.attrs_to_nodes.call(null,shape_key,cljs.core.conj.call(null,shape_pos_attrs,positions)));
});
playfair_cljs.shapes.move_text = (function move_text(p__12933){var map__12935 = p__12933;var map__12935__$1 = ((cljs.core.seq_QMARK_.call(null,map__12935))?cljs.core.apply.call(null,cljs.core.hash_map,map__12935):map__12935);var diffY = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"diffY","diffY",1109485670));var diffX = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"diffX","diffX",1109485669));var to_shape = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"to-shape","to-shape",2442812737));var to_node = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"to-node","to-node",4107897222));var from_node = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"from-node","from-node",1048241591));var shape_lookup = cljs.core.get.call(null,map__12935__$1,new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872));return [cljs.core.str("Move "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,shape_lookup)),cljs.core.str((cljs.core.truth_(diffX)?[cljs.core.str(" "),cljs.core.str(diffX),cljs.core.str("px horizontally "),cljs.core.str(diffY),cljs.core.str("px vertically")].join(''):[cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,from_node)),cljs.core.str(" to "),cljs.core.str(playfair_cljs.shapes.get_snap_name.call(null,to_shape)),cljs.core.str("'s "),cljs.core.str(cljs.core.name.call(null,to_node))].join('')))].join('');
});
playfair_cljs.shapes.shape_lookup_vars = new cljs.core.PersistentArrayMap(null, 6, [new cljs.core.Keyword(null,"draw","draw",1016996022),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"from-shape","from-shape",2082768688),new cljs.core.Keyword(null,"to-shape","to-shape",2442812737)], null),new cljs.core.Keyword(null,"scale","scale",1123155132),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872)], null),new cljs.core.Keyword(null,"move","move",1017261891),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872),new cljs.core.Keyword(null,"to-shape","to-shape",2442812737)], null),new cljs.core.Keyword(null,"rotate","rotate",4383690957),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"shape-lookup","shape-lookup",2731806872)], null),new cljs.core.Keyword(null,"path-start","path-start",761511980),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null),new cljs.core.Keyword(null,"path-extend","path-extend",1383118132),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null)], null);
playfair_cljs.shapes.get_cs_count = (function get_cs_count(cs){return cljs.core.reduce.call(null,(function (accum,p__12938){var vec__12939 = p__12938;var s_key = cljs.core.nth.call(null,vec__12939,0,null);var s_vec = cljs.core.nth.call(null,vec__12939,1,null);return cljs.core.assoc.call(null,accum,s_key,cljs.core.count.call(null,s_vec));
}),cljs.core.PersistentArrayMap.EMPTY,cs);
});
playfair_cljs.shapes.check_for_step = (function check_for_step(loop_ind,canvas_state){var cs_with_count = playfair_cljs.shapes.get_cs_count.call(null,canvas_state);return (function (p__12943){var map__12944 = p__12943;var map__12944__$1 = ((cljs.core.seq_QMARK_.call(null,map__12944))?cljs.core.apply.call(null,cljs.core.hash_map,map__12944):map__12944);var step = map__12944__$1;var step_name = cljs.core.get.call(null,map__12944__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));return cljs.core.reduce.call(null,(function (alt_step,l_var){if(cljs.core.truth_(l_var.call(null,alt_step)))
{var vec__12945 = l_var.call(null,alt_step);var s_name = cljs.core.nth.call(null,vec__12945,0,null);var s_ind = cljs.core.nth.call(null,vec__12945,1,null);if((s_name.call(null,cs_with_count) <= s_ind))
{return cljs.core.assoc.call(null,alt_step,l_var,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [s_name,(s_ind + loop_ind)], null));
} else
{return alt_step;
}
} else
{return alt_step;
}
}),step,step_name.call(null,playfair_cljs.shapes.shape_lookup_vars));
});
});
playfair_cljs.shapes.unwrap_for_step = (function unwrap_for_step(p__12946,canvas_state){var map__12948 = p__12946;var map__12948__$1 = ((cljs.core.seq_QMARK_.call(null,map__12948))?cljs.core.apply.call(null,cljs.core.hash_map,map__12948):map__12948);var for_steps = cljs.core.get.call(null,map__12948__$1,new cljs.core.Keyword(null,"for-steps","for-steps",1009839253));var times = cljs.core.get.call(null,map__12948__$1,new cljs.core.Keyword(null,"times","times",1124268728));var expanded_f_steps = cljs.core.vec.call(null,cljs.core.repeat.call(null,times,for_steps));return cljs.core.vec.call(null,cljs.core.map_indexed.call(null,(function (loop_ind,for_loop){return cljs.core.vec.call(null,cljs.core.map.call(null,playfair_cljs.shapes.check_for_step.call(null,loop_ind,canvas_state),for_loop));
}),expanded_f_steps));
});
playfair_cljs.shapes.for_text = (function for_text(p__12949){var map__12951 = p__12949;var map__12951__$1 = ((cljs.core.seq_QMARK_.call(null,map__12951))?cljs.core.apply.call(null,cljs.core.hash_map,map__12951):map__12951);var for_steps = cljs.core.get.call(null,map__12951__$1,new cljs.core.Keyword(null,"for-steps","for-steps",1009839253));var times = cljs.core.get.call(null,map__12951__$1,new cljs.core.Keyword(null,"times","times",1124268728));return [cljs.core.str("Repeat from 1 to "),cljs.core.str((times + 1))].join('');
});
playfair_cljs.shapes.cs = new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"rect","rect",1017400662),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"circle","circle",3948654658),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"path","path",1017337751),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"line","line",1017226086),cljs.core.PersistentVector.EMPTY], null);
playfair_cljs.shapes.step_func_dictionary = new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"draw","draw",1016996022),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.make_draw_cs,playfair_cljs.shapes.draw_text], null),new cljs.core.Keyword(null,"scale","scale",1123155132),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.make_scale_cs,playfair_cljs.shapes.scale_text], null),new cljs.core.Keyword(null,"rotate","rotate",4383690957),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.make_rotate_cs,playfair_cljs.shapes.rotate_text], null),new cljs.core.Keyword(null,"move","move",1017261891),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.make_move_cs,playfair_cljs.shapes.move_text], null),new cljs.core.Keyword(null,"for","for",1014005819),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [null,playfair_cljs.shapes.for_text], null),new cljs.core.Keyword(null,"path-start","path-start",761511980),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.start_path_cs,playfair_cljs.shapes.path_start_text], null),new cljs.core.Keyword(null,"path-extend","path-extend",1383118132),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [playfair_cljs.shapes.extend_path_cs,playfair_cljs.shapes.path_extend_text], null)], null);
playfair_cljs.shapes.add_active_for = (function add_active_for(for_steps,pre_for_index,check_index){var cs_steps = for_steps;var index = pre_for_index;var processed_cs_steps = cljs.core.PersistentVector.EMPTY;var active_section = 0;while(true){
if(cljs.core.truth_(cs_steps))
{var map__12955 = cljs.core.reduce.call(null,((function (cs_steps,index,processed_cs_steps,active_section){
return (function (p__12956,cs_step){var map__12957 = p__12956;var map__12957__$1 = ((cljs.core.seq_QMARK_.call(null,map__12957))?cljs.core.apply.call(null,cljs.core.hash_map,map__12957):map__12957);var active_section__$1 = cljs.core.get.call(null,map__12957__$1,new cljs.core.Keyword(null,"active-section","active-section",1833856656));var inner_cs_steps = cljs.core.get.call(null,map__12957__$1,new cljs.core.Keyword(null,"inner-cs-steps","inner-cs-steps",2228537491));var inner_index = cljs.core.get.call(null,map__12957__$1,new cljs.core.Keyword(null,"inner-index","inner-index",3629442573));return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"inner-index","inner-index",3629442573),(inner_index + 1),new cljs.core.Keyword(null,"inner-cs-steps","inner-cs-steps",2228537491),cljs.core.conj.call(null,inner_cs_steps,cljs.core.conj.call(null,cs_step,check_index.call(null,inner_index))),new cljs.core.Keyword(null,"active-section","active-section",1833856656),(cljs.core.truth_(check_index.call(null,inner_index))?Math.floor(((inner_index - pre_for_index) / cljs.core.count.call(null,cljs.core.first.call(null,for_steps)))):active_section__$1)], null);
});})(cs_steps,index,processed_cs_steps,active_section))
,new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"inner-index","inner-index",3629442573),index,new cljs.core.Keyword(null,"inner-cs-steps","inner-cs-steps",2228537491),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"active-section","active-section",1833856656),active_section], null),cljs.core.first.call(null,cs_steps));var map__12955__$1 = ((cljs.core.seq_QMARK_.call(null,map__12955))?cljs.core.apply.call(null,cljs.core.hash_map,map__12955):map__12955);var active_section__$1 = cljs.core.get.call(null,map__12955__$1,new cljs.core.Keyword(null,"active-section","active-section",1833856656));var inner_index = cljs.core.get.call(null,map__12955__$1,new cljs.core.Keyword(null,"inner-index","inner-index",3629442573));var inner_cs_steps = cljs.core.get.call(null,map__12955__$1,new cljs.core.Keyword(null,"inner-cs-steps","inner-cs-steps",2228537491));{
var G__12958 = cljs.core.next.call(null,cs_steps);
var G__12959 = inner_index;
var G__12960 = cljs.core.conj.call(null,processed_cs_steps,inner_cs_steps);
var G__12961 = active_section__$1;
cs_steps = G__12958;
index = G__12959;
processed_cs_steps = G__12960;
active_section = G__12961;
continue;
}
} else
{return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"processed-cs-steps","processed-cs-steps",3924943515),processed_cs_steps.call(null,active_section),new cljs.core.Keyword(null,"index","index",1114250308),index,new cljs.core.Keyword(null,"final-step","final-step",3401372725),cljs.core.last.call(null,cljs.core.last.call(null,processed_cs_steps))], null);
}
break;
}
});
playfair_cljs.shapes.data_variables = new cljs.core.PersistentArrayMap(null, 7, [new cljs.core.Keyword(null,"rotate","rotate",4383690957),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"rotate-val","rotate-val",934012705)], null),new cljs.core.Keyword(null,"draw","draw",1016996022),new cljs.core.PersistentVector(null, 4, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363),new cljs.core.Keyword(null,"diffX","diffX",1109485669),new cljs.core.Keyword(null,"diffY","diffY",1109485670)], null),new cljs.core.Keyword(null,"scale","scale",1123155132),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"scale-val","scale-val",3429794704)], null),new cljs.core.Keyword(null,"for","for",1014005819),new cljs.core.PersistentVector(null, 1, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"times","times",1124268728)], null),new cljs.core.Keyword(null,"move","move",1017261891),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"diffX","diffX",1109485669),new cljs.core.Keyword(null,"diffY","diffY",1109485670)], null),new cljs.core.Keyword(null,"path-start","path-start",761511980),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null),new cljs.core.Keyword(null,"path-extend","path-extend",1383118132),new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [new cljs.core.Keyword(null,"x","x",1013904362),new cljs.core.Keyword(null,"y","y",1013904363)], null)], null);
playfair_cljs.shapes.check_data = (function() {
var check_data = null;
var check_data__2 = (function (step_map,data){return check_data.call(null,step_map,data,0);
});
var check_data__3 = (function (step_map,data,loop_index){var data_vars = new cljs.core.Keyword(null,"step-name","step-name",2312562782).cljs$core$IFn$_invoke$arity$1(step_map).call(null,playfair_cljs.shapes.data_variables);return cljs.core.reduce.call(null,(function (new_step_map,p__12964){var vec__12965 = p__12964;var step_key = cljs.core.nth.call(null,vec__12965,0,null);var step_val = cljs.core.nth.call(null,vec__12965,1,null);return cljs.core.assoc.call(null,new_step_map,step_key,(cljs.core.truth_((function (){var and__3429__auto__ = cljs.core.some.call(null,(function (d_val){return cljs.core._EQ_.call(null,step_key,d_val);
}),data_vars);if(cljs.core.truth_(and__3429__auto__))
{return (step_val instanceof cljs.core.Keyword);
} else
{return and__3429__auto__;
}
})())?((cljs.core.vector_QMARK_.call(null,step_val.call(null,data)))?step_val.call(null,data).call(null,loop_index):step_val.call(null,data)):step_val));
}),cljs.core.PersistentArrayMap.EMPTY,step_map);
});
check_data = function(step_map,data,loop_index){
switch(arguments.length){
case 2:
return check_data__2.call(this,step_map,data);
case 3:
return check_data__3.call(this,step_map,data,loop_index);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
check_data.cljs$core$IFn$_invoke$arity$2 = check_data__2;
check_data.cljs$core$IFn$_invoke$arity$3 = check_data__3;
return check_data;
})()
;
playfair_cljs.shapes.for_state_maker = (function for_state_maker(exp_for_steps,data,cs){var cs__$1 = cs;var loops = exp_for_steps;var state = cljs.core.PersistentVector.EMPTY;var loop_index = 0;while(true){
if(cljs.core.truth_(loops))
{var inner_l_s = cljs.core.reduce.call(null,((function (cs__$1,loops,state,loop_index){
return (function (accum,p__12969){var map__12970 = p__12969;var map__12970__$1 = ((cljs.core.seq_QMARK_.call(null,map__12970))?cljs.core.apply.call(null,cljs.core.hash_map,map__12970):map__12970);var step = map__12970__$1;var step_name = cljs.core.get.call(null,map__12970__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));var vec__12971 = step_name.call(null,playfair_cljs.shapes.step_func_dictionary);var state_maker = cljs.core.nth.call(null,vec__12971,0,null);var text_maker = cljs.core.nth.call(null,vec__12971,1,null);var data_checked_step = playfair_cljs.shapes.check_data.call(null,step,data,loop_index);var last_cs = ((cljs.core._EQ_.call(null,cljs.core.count.call(null,accum),0))?cs__$1:cljs.core.last.call(null,accum).call(null,0));return cljs.core.conj.call(null,accum,new cljs.core.PersistentVector(null, 2, 5, cljs.core.PersistentVector.EMPTY_NODE, [state_maker.call(null,last_cs,data_checked_step),text_maker.call(null,step)], null));
});})(cs__$1,loops,state,loop_index))
,cljs.core.PersistentVector.EMPTY,cljs.core.first.call(null,loops));{
var G__12972 = cljs.core.last.call(null,inner_l_s).call(null,0);
var G__12973 = cljs.core.next.call(null,loops);
var G__12974 = cljs.core.conj.call(null,state,inner_l_s);
var G__12975 = (loop_index + 1);
cs__$1 = G__12972;
loops = G__12973;
state = G__12974;
loop_index = G__12975;
continue;
}
} else
{return state;
}
break;
}
});
playfair_cljs.shapes.steps_to_app_state = (function steps_to_app_state(p__12976){var map__12984 = p__12976;var map__12984__$1 = ((cljs.core.seq_QMARK_.call(null,map__12984))?cljs.core.apply.call(null,cljs.core.hash_map,map__12984):map__12984);var data = cljs.core.get.call(null,map__12984__$1,new cljs.core.Keyword(null,"data","data",1016980252));var active_steps = cljs.core.get.call(null,map__12984__$1,new cljs.core.Keyword(null,"active-steps","active-steps",1350401298));var steps = cljs.core.get.call(null,map__12984__$1,new cljs.core.Keyword(null,"steps","steps",1123665561));var func_lookup = playfair_cljs.shapes.step_func_dictionary;var active_step_range = cljs.core.range.call(null,active_steps.call(null,0),(active_steps.call(null,1) + 1));return new cljs.core.Keyword(null,"app-state","app-state",1424976215).cljs$core$IFn$_invoke$arity$1(cljs.core.reduce.call(null,(function (p__12985,p__12986){var map__12987 = p__12985;var map__12987__$1 = ((cljs.core.seq_QMARK_.call(null,map__12987))?cljs.core.apply.call(null,cljs.core.hash_map,map__12987):map__12987);var index = cljs.core.get.call(null,map__12987__$1,new cljs.core.Keyword(null,"index","index",1114250308));var canvas_state = cljs.core.get.call(null,map__12987__$1,new cljs.core.Keyword(null,"canvas-state","canvas-state",1660346190));var app_state = cljs.core.get.call(null,map__12987__$1,new cljs.core.Keyword(null,"app-state","app-state",1424976215));var map__12988 = p__12986;var map__12988__$1 = ((cljs.core.seq_QMARK_.call(null,map__12988))?cljs.core.apply.call(null,cljs.core.hash_map,map__12988):map__12988);var step = map__12988__$1;var step_name = cljs.core.get.call(null,map__12988__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));var vec__12989 = step_name.call(null,func_lookup);var state_maker = cljs.core.nth.call(null,vec__12989,0,null);var text_maker = cljs.core.nth.call(null,vec__12989,1,null);var check_index = ((function (vec__12989,state_maker,text_maker){
return (function (dex){return cljs.core.some.call(null,((function (vec__12989,state_maker,text_maker){
return (function (x){return cljs.core._EQ_.call(null,dex,x);
});})(vec__12989,state_maker,text_maker))
,active_step_range);
});})(vec__12989,state_maker,text_maker))
;if(cljs.core._EQ_.call(null,step_name,new cljs.core.Keyword(null,"for","for",1014005819)))
{var checked_step = playfair_cljs.shapes.check_data.call(null,step,data);var unwrap_steps = playfair_cljs.shapes.unwrap_for_step.call(null,checked_step,canvas_state);var state = playfair_cljs.shapes.for_state_maker.call(null,unwrap_steps,data,canvas_state);var map__12990 = playfair_cljs.shapes.add_active_for.call(null,state,index,check_index);var map__12990__$1 = ((cljs.core.seq_QMARK_.call(null,map__12990))?cljs.core.apply.call(null,cljs.core.hash_map,map__12990):map__12990);var final_step = cljs.core.get.call(null,map__12990__$1,new cljs.core.Keyword(null,"final-step","final-step",3401372725));var index__$1 = cljs.core.get.call(null,map__12990__$1,new cljs.core.Keyword(null,"index","index",1114250308));var processed_cs_steps = cljs.core.get.call(null,map__12990__$1,new cljs.core.Keyword(null,"processed-cs-steps","processed-cs-steps",3924943515));return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"app-state","app-state",1424976215),cljs.core.conj.call(null,app_state,new cljs.core.PersistentArrayMap(null, 4, [new cljs.core.Keyword(null,"name","name",1017277949),new cljs.core.Keyword(null,"for","for",1014005819),new cljs.core.Keyword(null,"steps","steps",1123665561),processed_cs_steps,new cljs.core.Keyword(null,"text","text",1017460895),text_maker.call(null,step),new cljs.core.Keyword(null,"final-step","final-step",3401372725),final_step], null)),new cljs.core.Keyword(null,"canvas-state","canvas-state",1660346190),cljs.core.first.call(null,final_step),new cljs.core.Keyword(null,"index","index",1114250308),(index__$1 + 1)], null);
} else
{var state = state_maker.call(null,canvas_state,playfair_cljs.shapes.check_data.call(null,step,data));return new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"app-state","app-state",1424976215),cljs.core.conj.call(null,app_state,new cljs.core.PersistentVector(null, 3, 5, cljs.core.PersistentVector.EMPTY_NODE, [state,text_maker.call(null,step),check_index.call(null,index)], null)),new cljs.core.Keyword(null,"canvas-state","canvas-state",1660346190),state,new cljs.core.Keyword(null,"index","index",1114250308),(index + 1)], null);
}
}),new cljs.core.PersistentArrayMap(null, 3, [new cljs.core.Keyword(null,"app-state","app-state",1424976215),cljs.core.PersistentVector.EMPTY,new cljs.core.Keyword(null,"canvas-state","canvas-state",1660346190),playfair_cljs.shapes.cs,new cljs.core.Keyword(null,"index","index",1114250308),0], null),steps));
});
playfair_cljs.shapes.count_all_steps = (function count_all_steps(steps){return cljs.core.reduce.call(null,(function (accum,p__12993){var map__12994 = p__12993;var map__12994__$1 = ((cljs.core.seq_QMARK_.call(null,map__12994))?cljs.core.apply.call(null,cljs.core.hash_map,map__12994):map__12994);var step = map__12994__$1;var step_name = cljs.core.get.call(null,map__12994__$1,new cljs.core.Keyword(null,"step-name","step-name",2312562782));if(cljs.core._EQ_.call(null,step_name,new cljs.core.Keyword(null,"for","for",1014005819)))
{return (accum + (cljs.core.count.call(null,new cljs.core.Keyword(null,"for-steps","for-steps",1009839253).cljs$core$IFn$_invoke$arity$1(step)) * new cljs.core.Keyword(null,"times","times",1124268728).cljs$core$IFn$_invoke$arity$1(step)));
} else
{return (accum + 1);
}
}),0,steps);
});
playfair_cljs.shapes.get_last_state = (function() {
var get_last_state = null;
var get_last_state__1 = (function (ls){return get_last_state.call(null,ls,false);
});
var get_last_state__2 = (function (ls,text_QMARK_){if(cljs.core.truth_(ls))
{var index = (cljs.core.truth_(text_QMARK_)?1:0);if(cljs.core.map_QMARK_.call(null,ls))
{return new cljs.core.Keyword(null,"final-step","final-step",3401372725).cljs$core$IFn$_invoke$arity$1(ls).call(null,index);
} else
{return ls.call(null,index);
}
} else
{if(cljs.core.truth_(text_QMARK_))
{return "";
} else
{return playfair_cljs.shapes.cs;
}
}
});
get_last_state = function(ls,text_QMARK_){
switch(arguments.length){
case 1:
return get_last_state__1.call(this,ls);
case 2:
return get_last_state__2.call(this,ls,text_QMARK_);
}
throw(new Error('Invalid arity: ' + arguments.length));
};
get_last_state.cljs$core$IFn$_invoke$arity$1 = get_last_state__1;
get_last_state.cljs$core$IFn$_invoke$arity$2 = get_last_state__2;
return get_last_state;
})()
;
playfair_cljs.shapes.get_last_cs = (function get_last_cs(app_state){return playfair_cljs.shapes.get_last_state.call(null,cljs.core.last.call(null,playfair_cljs.shapes.steps_to_app_state.call(null,app_state)));
});

//# sourceMappingURL=shapes.js.map